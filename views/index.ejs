<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Home</title>
    <link rel = "stylesheet" href = "css/style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
</head>

<body>

    <div id="header">

    </div> 

    <div id = "sidebar" class = "float-left">

        <div id="profile">
            <img id="profilePic" src="images/profile.png">
        </div>

        <svg height="160" width="200">
            <line x1="0" y1="160" x2="200" y2="160" style="stroke:lightgray;stroke-width:2;" />
        </svg>

        <div id = "options">
            <a href=".">Profile</a>
            <a href="/" class="active">View Images</a>
            <a href="/upload">Upload Images</a>
            <a href="/">Settings</a>
            <a href="/">Logout</a>
        </div>
    </div>

    <div id="main">
        
        <div style="overflow-y:auto;">
            <table id = "viewImages">
                <tr>
                    <th>No.</th>
                    <th>Filename</th>
                    <th>Image</th>
                    <th>Open</th>
                    <th>Delete</th>
                </tr>

                <% for(var i=0; i<array.length; i++) {%>
                    <tr>
                        <td><%= i %></td>
                        <td class = "nr"><span><%= array[i].filename %></span></td>
                        <td class = "data"><img src = <%= array[i].filename %>/></td>
                        <td class = "data"><button class='open' id='open' type='button'>Open</button></td>
                        <td class = "data"><button id='delete' type='button' formaction='/delete' formmethod='post'>Delete</button></td>
                    </tr>
                <%}%>

            </table>
        </div>

    </div>

    <script>
        $(".open").click(function() {
            var $row = $(this).closest("tr");    // Find the row
            var $text = $row.find(".nr").text(); // Find the text
            // var img = document.createElement('img');
            // img.src = $text;
            // document.getElementById('main').appendChild(img)
            
            var xhr = new XMLHttpRequest();
            xhr.open("POST", '/image', true);
            xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
            xhr.send(JSON.stringify({
                value: $text
            }));
        });
    </script>

</body>

</html>